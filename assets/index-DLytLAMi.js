(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))t(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const i of c.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&t(i)}).observe(document,{childList:!0,subtree:!0});function r(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function t(o){if(o.ep)return;o.ep=!0;const c=r(o);fetch(o.href,c)}})();function f(e,n,r,t){e.images[t]&&(n.classList.remove("hidden"),document.body.classList.add("modal-open"),r.src=e.images[t].urls.regular,r.alt=e.images[t].alt_description||"",e.currentIndex=t)}function m(e,n){e.classList.add("hidden"),document.body.classList.remove("modal-open"),n.src=""}function p(e,n,r){e.currentIndex=(e.currentIndex+1)%e.images.length,f(e,n,r,e.currentIndex)}function h(e,n,r){e.currentIndex=(e.currentIndex-1+e.images.length)%e.images.length,f(e,n,r,e.currentIndex)}function E(e){const n=document.createElement("div");n.className="modal hidden",n.innerHTML=`
      <div class="modal-overlay"></div>
      <div class="modal-content">
        <button class="modal-close">&times;</button>
        <button class="modal-prev">&#10094;</button>
        <img class="modal-image" src="" alt="">
        <button class="modal-next">&#10095;</button>
      </div>
    `,document.body.appendChild(n);const r=n.querySelector(".modal-image"),t=n.querySelector(".modal-close"),o=n.querySelector(".modal-overlay"),c=n.querySelector(".modal-prev"),i=n.querySelector(".modal-next");return t.addEventListener("click",()=>m(n,r)),o.addEventListener("click",()=>m(n,r)),document.addEventListener("keydown",s=>{s.key==="Escape"&&m(n,r),s.key==="ArrowRight"&&p(e,n,r),s.key==="ArrowLeft"&&h(e,n,r)}),i.addEventListener("click",()=>p(e,n,r)),c.addEventListener("click",()=>h(e,n,r)),{setImages(s){if(!Array.isArray(s))throw new Error("setImages expects array");e.images=s},open(s){f(e,n,r,s)}}}const w="https://api.unsplash.com/search/photos",I="4BhH6aovDpv84FFGv_p1vREzcXmcZQf3zRkCy2s9Ovs",b=/^[\wа-яА-ЯёЁ0-9 !$&*\-=^`|~#%' +/?_{}]{2,30}$/i,P="nature",S=30;async function x(e,n=1){const r=await fetch(`${w}?query=${encodeURIComponent(e)}&page=${n}&per_page=${S}&orientation=squarish`,{headers:{Authorization:`Client-ID ${I}`}});if(!r.ok)throw new Error(`Error: ${r.status}`);const t=await r.json();if(!(t!=null&&t.results))throw new Error("Incorrect response from API");return t.results}function C(e,n){const r=document.createElement("p");r.className="error-message",r.textContent=e,n.appendChild(r)}function q(e,n,r){if(!e.length&&n.currentPage===1){r.textContent="Nothing found for your request.";return}const t=document.createDocumentFragment();e.forEach((o,c)=>{const i=document.createElement("div");i.className="card",i.dataset.index=n.images.length-e.length+c;const s=document.createElement("img");s.src=o.urls.small,s.alt=o.alt_description||"Image",i.appendChild(s),t.appendChild(i)}),r.appendChild(t)}async function A(e,n,r,t,o,c,i){e.preventDefault();const s=r.value.trim();if(!b.test(s)){t.textContent="Please enter between 2 and 30 valid characters.",t.classList.add("visible");return}t.textContent="",t.classList.remove("visible"),n.currentQuery=s,n.currentPage=1,await g(n,o,c,i)}async function g(e,n,r,t){e.isLoading=!0,r.classList.remove("hidden");try{const o=await x(e.currentQuery,e.currentPage);e.currentPage===1&&(n.innerHTML="",e.images=[]),e.images=[...e.images,...o],q(o,e,n),t.setImages(e.images)}catch(o){C(`Loading error: ${o.message}`,n)}finally{r.classList.add("hidden"),e.isLoading=!1}}function N(e,n,r,t){const o=window.innerHeight+window.scrollY,c=document.body.offsetHeight-100;o>=c&&!e.isLoading&&(e.currentPage++,g(e,n,r,t))}function _(e,n){const r=e.target.closest(".card");if(!r)return;const t=parseInt(r.dataset.index);isNaN(t)||n.open(t)}const y=document.querySelector(".search-form"),v=document.querySelector(".js-search-input"),L=document.querySelector(".js-error-message"),a=document.querySelector(".js-gallery"),l=document.querySelector(".js-loader");if(!y||!v||!L||!a||!l)throw new Error("Missing essential DOM elements");const u={currentQuery:P,currentPage:1,isLoading:!1,images:[],currentIndex:0},d=E(u);function O(){g(u,a,l,d)}function R(){y.addEventListener("submit",e=>A(e,u,v,L,a,l,d)),window.addEventListener("scroll",()=>N(u,a,l,d)),a.addEventListener("click",e=>_(e,d))}R();O();
